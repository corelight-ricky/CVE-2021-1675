# PrintNightmare (CVE-2021-1675)

This Zeek script detects successful `RpcAddPrinterDriver{,Ex}` DCE RPC events,
which are required to successfully exploit the vulnerability. Tests are based on
exploit PCAP from [Lares Lab](https://github.com/LaresLLC/CVE-2021-1675). Tested
with Zeek versions `3.0.2` and `4.0.1`.

## Notices

* `Printer_Driver_Changed_Successfully` indicates the printer driver was changed successfully.

## Suricata

The Suricata rules we had here prior were not up to snuff and have accordingly
been removed. They are available in the commit history for interested
parties. They generated far too many false positives to be of production use.

## References

* https://github.com/LaresLLC/CVE-2021-1675
* https://github.com/afwu/PrintNightmare
* https://github.com/cube0x0/CVE-2021-1675
